#Created by Ioannis-Iason Dimitriadis and Othonas Katsouris 05/12/2022
from datetime import date, datetime
import os

class venue:
    def __init__(self):          #constructor
        self.name = input('Enter the name of the industrial sight: ')
        self.location = input('Enter the place that this industrial sight is located: ')
        self.mtime = input('Enter the times that these sights are open to the public in the morning: ')
        self.atime = input('Enter the times that these sights are open to the public in the afternoon: ')

    def add_venue(self):     #adding venues to file function
        add_venue = self.name + " | " + self.location + " | " + self.mtime + " | " + self.atime + "\n"
        text_file = open("venues.txt", "a")  # opening file
        text_file.write(add_venue)                    # writing in file
        text_file.close()                           # closing file

    def delete_venue(self, delete):  #deleting venues from file function
        with open("venues.txt", "r") as input:       #uses venues as input file
            with open("temp.txt", "w") as output:           #uses temp as a temporary output file
                for line in input:
                    if delete not in line.strip("\n"):      #if the keyword delete is anywhere within the file, delete the entire line
                        output.write(line)
        os.remove("venues.txt")
        os.replace('temp.txt', 'venues.txt')         #rename temp to venues

class user:
    def __init__(self,username,password):          #constructor
        self.username = username
        self.password = password

    def username_exists(self):
        with open ('logins.txt', 'r') as file:     #r means that it reads
            lines = file.readlines()
            for line in lines:
                username_array = line.split("|")
                if username_array[0]==self.username:
                    return True
        return False
           
    def register(self):
        if self.username_exists():
            return False
        with open ('logins.txt', 'a') as file:     #a+ means that it appends
            newline = self.username + "|" + self.password + "\n"
            file.write(newline)
        return True

    def login(self):
        with open ('logins.txt', 'r') as file:     #r means that it reads
            lines = file.readlines()
            for line in lines:
                username_array = line.split("|")
                if username_array[0]==self.username and username_array[1][:-1]==self.password: # python adds the new line as a new character. when i slice the password it has an extra character that i remove using [:-1]
                    return True
        return False
           
#------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
highseasonstart1 = date(2022,2,15)
highseasonend1 = date(2022,3,31)
highseasonstart2 = date(2022,10,15)
highseasonend2 = date(2022,11,15)
midseasonstart = date(2022,4,1)
midseasonend = date(2022,5,14)
x = int(input("Please register by pressing 1 , login by pressing 2, or login as administrator by pressing 3: "))
while x < 1 or x > 3:  #start of while
        answer = int(input("Please enter a number between 1 and 3"))
        if x == 1 or x ==2 or x == 3:
            break
if x == 1:
    # REGISTRATION
    username = input("Please provide a username for your account: ")
    password = input("Please provide a password for your account: ")
    u = user(username, password)
    while u.register() is False: #start of username verification
        username = input("This name has already been taken, please input another one: ")
        u = user(username, password)        
    #end of username verification
    x = 2
elif x == 2 :
    # LOGIN
    username = input("Please provide your username: ")
    password = input("Please enter your password: ")
    u = user(username,password)
    while u.login() is False: #start of login verification
        username = input("Reenter your username: ")
        password = input("Reenter your password: ")
        u = user(username, password)
    print("Welcome user")
